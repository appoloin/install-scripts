name: Stellaris
game_slug: stellaris
version: Good Old Games Installer
slug: stellaris
runner: wine
year: 2016

script:
  game:
    exe: $GAMEDIR/drive_c/GOG Games/Stellaris/Launch Stellaris.lnk
    prefix: $GAMEDIR

  files:
    - setup: N/A:Select Surviving Mars installer
    - DLC1: N/A:Select DLC

  installer:
    - task:
        name: create_prefix
        install_mono: false
        install_gecko: false
        prefix: $GAMEDIR

    - task:
        executable: $setup
        description: 'Installing Surviving Mars'
        name: wineexec
        prefix: $GAMEDIR

    # Link $DLC1 folder to Prefix DLC folder
    - execute:
        command: 'src_path=$(echo "$DLC1" | sed -r "s/(.+)\/.+/\1/");


                  ln -s -f -n "$src_path" "$GAMEDIR/drive_c/DLC"
                  '

    # DLC Mass Installer
    - write_file: 
        content: '@echo off

          REM Set the directory where the .exe files are located
                   
          C: 
          
          set FullPath="c:\dlc"

          echo %FullPath%

          REM Change to the specified directory

          cd /d %FullPath%

          REM Loop through each .exe file in the directory and run it with the /SILENT flag

          for %%f in (*.exe) do (
                
            start /wait "" "%%f" /SILENT

           )
         '
        file: $GAMEDIR/dlc_install.cmd

    - task:
        executable: $GAMEDIR/dlc_install.cmd
        name: wineexec
        prefix: $GAMEDIR

