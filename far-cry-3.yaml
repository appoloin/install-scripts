name: FarCry3 
game_slug: far-cry-3
version: Installer
slug: installer
runner: wine

script:
  game:
    exe: "$GAMEDIR/drive_c/Program Files/Ubisoft/FarCry 3/bin/farcry3.exe"
    arch: win32
    prefix: $GAMEDIR

  files:
    - game: N/A:Select installer.
    - patch: N/A:Select Game Patch
    - uplay: N/A:Select Uplay upgrade ;)

  installer:
    - task:
        arch: win32
        name: create_prefix
        install_mono: false
        install_gecko: false
        prefix: $GAMEDIR

    - task:
        arch: win32
        app: d3dx10 d3dcompiler_43 vcrun2010 vcrun2015 dotnet35 xact
        name: winetricks
        prefix: $GAMEDIR

    - task:
        arch: win32
        description: Installing
        executable: $game
        name: wineexec
        prefix: $GAMEDIR

    - task:
        arch: win32
        description: Installing
        executable: $patch
        name: wineexec
        prefix: $GAMEDIR

    - write_file:
        content: '#!/bin/bash

         src=$1
        
         dst=$2
                                                   
         find "$dst" -maxdepth 1 -type f \( -iname "FC3.dll" -o
                                            -iname "FC3_d3d11.dll" -o
                                            -iname "orbit_api.ini" -o
                                            -iname "ubiorbitapi-_r2_loader.dll" -o
                                            -iname "uplay_r1_loader" \) -exec rm {}  \;'
        file: $CACHE/remove.sh
    - chmodx: $CACHE/remove.sh

    - execute:
        file: 7z
        args: e $uplay -o$GAMEDIR/drive_c/Program Files/Ubisoft/FarCry 3/bin

  wine:
    Desktop: true