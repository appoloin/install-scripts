name: The Crew
game_slug: the-crew
version: Windows Installer
slug: the-crew
runner: wine
year: 2014

script:
  files:
    - setup: N/A:Select setup file from GOG
    - launcher:  
        url: https://github.com/appoloin/Patches/raw/refs/heads/master/TheCrew/TCULauncher-1.1.6.1.7z
        filename:  TCULauncher-1.1.6.1.7z
    - fix1:
        url: https://github.com/appoloin/Patches/raw/refs/heads/master/TheCrew/Patch.7z.001
        filename:  Patch.7z.001
    - fix2:
        url: https://github.com/appoloin/Patches/raw/refs/heads/master/TheCrew/Patch.7z.002
        filename:  Patch.7z.002

  game:
    exe: "$GAMEDIR/drive_c/Games/The Crew/TCULauncher.exe"
    prefix: $GAMEDIR

  installer:
    - task:
        name: create_prefix
        install_mono: false
        install_gecko: false
        prefix: $GAMEDIR

    - task:
        app: xact_x64 xact dotnetdesktop8
        name: winetricks
        prefix: $GAMEDIR

    - task:
        executable: $setup
        name: wineexec
        prefix: $GAMEDIR

    #Move Patch into one folder
    - merge:
        src: "$fix1"
        dst: "$CACHE"
    - merge:
        src: "$fix2"
        dst: "$CACHE"

    - execute:
        file: 7z
        args: x  $CACHE/Patch.7z.001 -o"$GAMEDIR/drive_c/Games/The Crew/" -ppassword -y

    - execute:
        file: 7z
        args: x  $launcher -o"$GAMEDIR/drive_c/Games/The Crew/" -ppassword -y

    - rename:
        src: "$GAMEDIR/drive_c/Games/The Crew/data_win32/pc_steam_ww" 
        dst: "$GAMEDIR/drive_c/Games/The Crew/data_win32/pc_ww" 

    #remove
    - execute:
        command: 'find "$GAMEDIR/drive_c/Games/The Crew/" -maxdepth 1  -type d \( -iname steam_* \) -exec rm -r {} \;'

  wine:
    overrides:
      dinput8 : n,b
    esync: false
    fsync: false

