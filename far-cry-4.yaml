name: Far Cry 4
game_slug: far-cry-4
version: Installer
slug: installer
runner: wine

script:
  game:
    exe: "$GAMEDIR/drive_c/Program Files (x86)/Far Cry 4/bin/FarCry4.exe"
    prefix: $GAMEDIR

  files:
    - game: N/A:Select installer.
    - uplay: N/A:Select Uplay upgrade ;)

  installer:
    - task:
        name: create_prefix
        install_mono: false
        install_gecko: false
        prefix: $GAMEDIR

    - task:
        app: d3dx10 vcrun2010 vcrun2015 xact_x64 dotnet35 d3dcompiler_43 winxp
        name: winetricks
        prefix: $GAMEDIR
        
    - task:
        description: Installing
        executable: $game
        name: wineexec
        prefix: $GAMEDIR

    - write_file:
        content: '#!/bin/bash
                                                           
         find "$1" -maxdepth 1 -type f \( -iname "doge.dll" -o
                                            -iname "orbit_api.ini" -o
                                            -iname "steam_api.dll" -o
                                            -iname "steam_api.ini" -o
                                            -iname "steam_api64.dll" -o
                                            -iname "uplay_r1_loader64.dll" -o
                                            -iname "uplay_r164.dll" \) -exec rm {}  \;'
        file: $CACHE/remove.sh
    - chmodx: $CACHE/remove.sh

    - execute:
        args: "$GAMEDIR/drive_c/Program\ Files\ (x86)/Far\ Cry\ 4/bin/"
        file: $CACHE/remove.sh

    - execute:
        file: 7z
        args: e $uplay -o"$GAMEDIR/drive_c/Program Files (x86)/Far Cry 4/bin/"

  wine:
    Desktop: true