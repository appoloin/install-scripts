name: Versailles 1685
game_slug: versailles-1685
version: Installer
slug: versailles-1685
runner: scummvm


script:
  files:
    - DISC1: N/A:Select install.exe from Disc1.
    - DISC2: N/A:Select autorun.exe from Disc2.

  game:
    game_id: versailles
    path: $GAMEDIR

  installer:
    - write_file:
        content: '#!/bin/bash

        src=$1

        dst=$2

        src_path=$(echo "$1" | sed -r "s/(.+)\/.+/\1/")

        find "$src_path" -maxdepth 1 -type d \( -iname "DATAS_V" \) -exec cp -r {} "$dst" \;

        find "$src_path" -type f \( -iname "versaill.pgm" \) -exec cp {} "$dst" \;'
        file: $CACHE/selectcopy.sh
    - chmodx: $CACHE/selectcopy.sh 

    - copy:
        src: dat
        dst: $GAMEDIR

    - execute:
        args: $DISC1 $GAMEDIR
        file: $CACHE/selectcopy.sh

    - execute:
        args: -R 775  $GAMEDIR
        file: /bin/chmod

    - execute:
        args: $DISC2 $GAMEDIR
        file: $CACHE/selectcopy.sh

    - execute:
        args: -R 775  $GAMEDIR
        file: /bin/chmod

    - merge:
        src: "$GAMEDIR/data_v"
        dst: "$GAMEDIR"

