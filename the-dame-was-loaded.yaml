name: The Dame was Loaded
game_slug: the-dame-was-loaded
version: Installer
slug: the-dame-was-loaded
runner: dosbox


script:
  game:
    main_file: $GAMEDIR/Dame.conf

  files:
    - DISC1: N/A:Select Setup.exe.
    - DISC2: N/A:Select demo.bat.

  installer:  
    - write_file:
        content: '#!/bin/bash

            src=$1

            dst=$2
        
            src_path=$(echo "$1" | sed -r "s/(.+)\/.+/\1/")

            cp -avr "$src_path/."  "$dst"'
        file: $CACHE/bulkcopy-alt.sh

    - chmodx: $CACHE/bulkcopy-alt.sh
  
    - execute:
        args: $GAMEDIR/HDD $GAMEDIR/CDD $GAMEDIR/CDD/DISC1
        file: mkdir


    - execute:
        args: $DISC1 "$GAMEDIR/CDD/DISC1"
        file: $CACHE/bulkcopy-alt.sh

    - execute:
        args: -R 775  "$GAMEDIR/CDD/DISC1"
        file: chmod

    - execute:
        args: $DISC2 "$GAMEDIR/CDD/DISC1"
        file: $CACHE/bulkcopy-alt.sh

    - execute:
        args: -R 775  "$GAMEDIR/CDD/DISC1"
        file: chmod


    - write_file:
        content: '          [mouse]

            capture_mouse = onstart middlerelease  

            mouse_sensitivity= 15

            [autoexec]
            
            mount C "$GAMEDIR/HDD" -t dir

            mount D "$GAMEDIR/CDD/DISC1" -label DAME_CD1 -t cdrom

            mount E "$GAMEDIR/CDD/DISC2" -label DAME_CD2 -t cdrom

            D:

            install
            
            exit'
        file: $GAMEDIR/Dame_setup.conf
    - task:
        config_file: $GAMEDIR/Dame_setup.conf
        name: dosexec
        working_dir: $GAMEDIR/HDD/
        
    - write_file:
        content: '[mouse]

            capture_mouse = onstart middlerelease  

            mouse_sensitivity= 15

            [sdl]

            fullresolution=desktop

            windowresolution=original

            output=opengl

            [render]

                aspect=true

            scaler=normal2x
        
            [autoexec]
            
            mount C "$GAMEDIR/HDD" -t dir

            mount D "$GAMEDIR/CDD/DISC1"  -label DAME_CD1 -t cdrom

            mount E "$GAMEDIR/CDD/DISC2"  -label DAME_CD2 -t cdrom

            C:


            ECHO OFF

            goto launcher

            :launcher

            cls 

            ECHO  -------------------------------------------  
            
            ECHO              The Dame was Loaded
            
            ECHO  -------------------------------------------  
            
            ECHO   1) Play        
            
            ECHO   2) Set Sound                                   
            
            ECHO   3) Install

            ECHO  -------------------------------------------  
            
            ECHO   4) Exit                             
            
            ECHO  -------------------------------------------  

            choice /c1234 /s Which program do you want to run? [1-4]: /n 
            
            if errorlevel 4 goto exit
                        
            if errorlevel 3 goto install

            if errorlevel 2 goto setup
            
            if errorlevel 1 goto game


            :game

            cls

            C:

            cd DAME

            DAME.EXE

            goto exit


            :setup

            cls

            C:

            cd DAME
            
            setup.EXE

            goto launcher


            :install
            
            D:

            install

            goto launcher

            
            :exit
            
            exit'
        file: $GAMEDIR/Dame.conf