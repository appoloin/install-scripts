name: The Mystery at Greveholm 2
game_slug: the-mystery-at-greveholm-2
version: Win9x
slug: the-mystery-at-greveholm-2
runner: linux
year: 1998

script:
  files:
    - game: N/A:Select first ISO, all ISO's in folder will be copied
    - dbpu_file:
        url: https://github.com/legluondunet/mlls-tools/raw/refs/heads/master/DOSBox/dosbox-pure-unleashed.tar.xz
        filename: dosbox-pure-unleashed.tar.xz
    - dbpu_save: 
        url: https://github.com/appoloin/Patches/raw/refs/heads/master/System/DOSBox-pure.pure.zip
        filename: DOSBox-pure.pure.zip
    - os_img:
        url: https://lutris.nyc3.cdn.digitaloceanspaces.com/games/Windows_95/WIN95_OSR25_DBP_2Go.7z
        filename: WIN95_OSR25_DBP_2Go.7z

  game:
    args: "'$GAMEDIR/CD/PLANUTUS.iso'"
    exe: $GAMEDIR/DOSBoxPure_x86_64
    working_dir: $GAMEDIR

  install_complete_text: "Installation of Win95 has finished!\n\n\n\nIMPORTANT!\n============\nTo Install game run installer in Win95. \ 
     \n\n Ctrl+F11 Grabs Mouse \n\n Crtl+F12 Disc Swap \
     \n\n\n Always Shut Down Window 95 using menu."


  installer:
    - execute:
        file: mkdir
        args: $GAMEDIR/CD

     #copy select
    - execute:
        command: 'src_path=$(echo "$game" | sed -r "s/(.+)\/.+/\1/")

                  find "$src_path" -type f \( -iname "*.ISO" -o 
                                              -iname "*.cue" -o 
                                              -iname "*.bin" \) -exec cp {} "$GAMEDIR/CD" \;'

    - extract:
        file: dbpu_file
        dst: $GAMEDIR
        
    - extract:
        src: os_img
        dst: $GAMEDIR/system

    - merge:
        src: dbpu_save
        dst: $GAMEDIR/saves
