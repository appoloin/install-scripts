name: Hexen - Deathkings of the Dark Citadel
game_slug: hexen-deathkings-of-the-dark-citadel
version: Installer
slug: hexen-deathkings-of-the-dark-citadel
runner: zdoom


script:
    files:
      - game: N/A:Select GOG installer.
      - inno: https://lutris.nyc3.digitaloceanspaces.com/tools/innoextract/innoextract-1.8-dev-2019-01-13-linux.tar.xz

    game:
      main_file: $GAMEDIR/HEXEN.WAD
      savedir: $GAMEDIR/saves

    installer:
      - write_file:
          content: '#!/bin/bash

          src=$1

          dst=$2

          src_path=$(echo "$1" | sed -r "s/(.+)\/.+/\1/")

          find "$src_path" -type f \( -iname "HEXEN.WAD" \) -exec cp {} "$dst" \;'
          
          file: $CACHE/selectcopy.sh
      - chmodx: $CACHE/selectcopy.sh

      - extract:
          dst: $CACHE
          file: $inno
        
      - execute:
          args: -d "$CACHE" "$game"
          file: $CACHE/innoextract

      - execute:
          args: $CACHE $GAMEDIR
          file: $CACHE/selectcopy.sh