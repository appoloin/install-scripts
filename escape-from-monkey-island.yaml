name: Escape from Monkey Island
game_slug: escape-from-monkey-island
version: Installer
slug:  Monkey4-installer
runner: scummvm

script:
  files:
    - patch : https://downloads.scummvm.org/frs/extras/patches/MonkeyUpdate.exe

  game:
    game_id: monkey4
    path: $GAMEDIR

  installer:
    - write_file:
        content: '#!/bin/bash

            src=$1

            dst=$2

            cp -avr "$src/."  "$dst"'
        file: $CACHE/bulkcopy-alt.sh

    - chmodx: $CACHE/bulkcopy-alt.sh

    - insert-disc:
        description: Please insert disc 1
        requires: Monkey4
    
    - execute:
        args: $DISC/Monkey4/MonkeyData $GAMEDIR
        file: $CACHE/bulkcopy-alt.sh

    - execute:
        file: cp
        args: "'$DISC/Monkey4/MonkeyInstall/local.m4b' '$CACHE'"
    
    - execute:
        file: chmod
        args: -R 775  "$GAMEDIR"

    - execute:
        file: cp
        args: "'$DISC/Monkey4/MonkeyData/voiceAll.m4b' '$CACHE'"

    - execute:
        file: mv
        args: $GAMEDIR/Textures/FullMonkeyMap.imt   $GAMEDIR/Textures/FullMonkeyMap1.imt 

    - insert-disc:
        description: Please insert disc 2
        requires: Monkey4
    
    - execute:
        file: $CACHE/bulkcopy-alt.sh
        args: $DISC/Monkey4/MonkeyData $GAMEDIR
    
    - execute:
        file: chmod
        args: -R 775  "$GAMEDIR"

    - execute:
        file: mv
        args: $GAMEDIR/Textures/FullMonkeyMap.imt   $GAMEDIR/Textures/FullMonkeyMap2.imt 

    - execute:
        file: rm
        args: $GAMEDIR/voiceAll.m4b

    - execute:
        file: cp
        args: $CACHE/voiceAll.m4b $GAMEDIR

    - execute:
        file: cp
        args: $CACHE/local.m4b  $GAMEDIR

    - copy:
        src: $patch
        dst: $GAMEDIR

