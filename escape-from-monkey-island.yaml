name: Escape from Monkey Island
game_slug: escape-from-monkey-island
version: Installer
slug:  Monkey4-installer
runner: scummvm

script:
    files:
        - patch : https://downloads.scummvm.org/frs/extras/patches/MonkeyUpdate.exe

    game:
        game_id: monkey4
        path: $GAMEDIR

    installer:
    - write_file:
        content: '#!/bin/bash

            src=$1

            dst=$2

            cp -avr "$src/."  "$dst"'
        file: $CACHE/bulkcopy-alt.sh

    - chmodx: $CACHE/bulkcopy-alt.sh

    - insert-disc:
        description: Please insert disc 1
        requires: Monkey4
    
    - execute:
        args: $DISC/Monkey4/MonkeyData $GAMEDIR
        file: $CACHE/bulkcopy-alt.sh

    - execute:
        args: "'$DISC/Monkey4/MonkeyInstall/local.m4b' '$CACHE'"
        file: cp
    
    - execute:
        args: -R 775  "$GAMEDIR"
        file: chmod

    - execute:
        args: "'$DISC/Monkey4/MonkeyData/voiceAll.m4b' '$CACHE'"
        file: cp

    - execute:
        args: $GAMEDIR/Textures/FullMonkeyMap.imt   $GAMEDIR/Textures/FullMonkeyMap1.imt 
        file: mv

    - insert-disc:
        description: Please insert disc 2
        requires: Monkey4
    
    - execute:
        args: $DISC/Monkey4/MonkeyData $GAMEDIR
        file: $CACHE/bulkcopy-alt.sh
    
    - execute:
        args: -R 775  "$GAMEDIR"
        file: chmod

    - execute:
        args: $GAMEDIR/Textures/FullMonkeyMap.imt   $GAMEDIR/Textures/FullMonkeyMap2.imt 
        file: mv

    - execute:
        args: $GAMEDIR/voiceAll.m4b
        file: rm

    - execute:
        args: $CACHE/voiceAll.m4b $GAMEDIR
        file: cp

    - execute:
        args: $CACHE/local.m4b  $GAMEDIR
        file: cp

    - copy:
        dst: $GAMEDIR
        src: $patch

