name: Sam & Max - EP 302 - The Tomb of Sammin-mak
game_slug: sam-max-302-the-tomb-of-sammun-mak
version: Installer
slug: installer
runner: wine

script:
  game:
    exe: "$GAMEDIR/drive_c/GOG/Episode 302 - The Tomb of Sammun-Mak/SamMax302.exe"
    arch: win32
    prefix: $GAMEDIR

  files:
  - game: N/A:Select Sam & Max - The Devils Playhouse installer.
  - inno: https://lutris.nyc3.digitaloceanspaces.com/tools/innoextract/innoextract-1.8-dev-2019-01-13-linux.tar.xz

  installer:
    - task:
        name: create_prefix
        arch: win32
        install_mono: false
        install_gecko: false
        prefix: $GAMEDIR

    - task:
        app: d3dx9 directmusic dsound xact
        arch: win32
        name: winetricks
        prefix: $GAMEDIR

    - execute:
        args: $GAMEDIR/drive_c/GOG  "$GAMEDIR/drive_c/GOG/Episode 302 - The Tomb of Sammun-Mak"
        file: mkdir
    
    - extract:
        dst: $CACHE
        file: $inno

    - execute:
        args: -I "Episode 302 - The Tomb of Sammun-Mak" -d "$CACHE" "$game"
        file: $CACHE/innoextract

    - merge:
        dst: "$GAMEDIR/drive_c/GOG/Episode 302 - The Tomb of Sammun-Mak"
        src: "$CACHE/app/Episode 302 - The Tomb of Sammun-Mak"

  wine:
    Desktop: true

