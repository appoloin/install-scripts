name: Far Cry 3 Blood Dragon
game_slug: far-cry-3-blood-dragon
version: Installer
slug: installer
runner: wine

script:
  game:
    exe: "$GAMEDIR/drive_c/Program Files/Ubisoft/Far Cry 3 Blood Dragon/bin/fc3_blooddragon_d3d11.exe"
    arch: win32
    prefix: $GAMEDIR

  files:
    - game: N/A:Select installer.
    - uplay: N/A:Select Uplay upgrade ;)

  installer:
    - task:
        name: create_prefix
        install_mono: false
        install_gecko: false
        prefix: $GAMEDIR

    - task:
        app: dotnet35 vcrun2010 vcrun2015 d3dx10 d3dcompiler_43 xact 
        name: winetricks
        prefix: $GAMEDIR

    - task:
        description: Installing
        executable: $game
        name: wineexec
        prefix: $GAMEDIR

    - write_file:
        content: '#!/bin/bash

         src=$1
                                                           
         find "$src" -maxdepth 1 -type f \( -iname "FC3.dll" -o
                                            -iname "FC3_d3d11.dll" -o
                                            -iname "orbit_api.ini" -o
                                            -iname "ubiorbitapi-_r2_loader.dll" -o
                                            -iname "uplay_r1_loader" -o
                                            -iname "fc3_blooddragon.exe" -o
                                            -iname "fc3_blooddragon_d3d11.exe" \) -exec rm {} \;'
        file: $CACHE/remove.sh
    - chmodx: $CACHE/remove.sh

    - execute:
        args: $GAMEDIR
        file: $CACHE/remove.sh

    - execute:
        file: 7z
        args: e $uplay -o$GAMEDIR/drive_c/Program Files/Ubisoft/Far Cry 3 Blood Dragon/bin/


  wine:
    Desktop: true